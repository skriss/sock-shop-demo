box: google/golang

build:
    steps:
      - script: 
          name: copy app YAML
          code: cp sock-shop.yaml "$WERCKER_OUTPUT_DIR"

deploy-config:
    steps:
      - kubectl:
          name: configure creds
          server: $KUBERNETES_MASTER
          token: $KUBERNETES_TOKEN
          insecure-skip-tls-verify: true
          command: config set-credentials wercker --token=$KUBERNETES_TOKEN
      - kubectl:
          name: deploy to kubernetes
          server: $KUBERNETES_MASTER
          insecure-skip-tls-verify: true
          command: apply -f sock-shop.yaml