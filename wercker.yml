box: google/golang

build:
    steps:
      - script: 
          name: copy app YAML
          code: cp sock-shop.yaml "$WERCKER_OUTPUT_DIR"

deploy-config:
    steps:
      - script:
            name: create kubeconfig
            code: |
              echo "$KUBERNETES_CONFIG" > ~/.kube/config

      - kubectl:
          name: deploy to kubernetes
          server: $KUBERNETES_MASTER
          insecure-skip-tls-verify: true
          command: apply -f sock-shop.yaml